# -*- coding: utf-8 -*-

import scrapy
from getdetail import items
from scrapy.http import Request
import json
import re

# ids = ['3',
#  '2',
#  '1',
#  '180',
#  '259',
#  '237',
#  '183',
#  '238',
#  '12',
#  '20',
#  '6',
#  '18',
#  '7',
#  '14',
#  '17',
#  '16',
#  '5',
#  '219',
#  '15',
#  '13',
#  '111',
#  '9',
#  '10',
#  '4',
#  '19',
#  '8',
#  '140',
#  '11',
#  '239',
#  '236',
#  '244',
#  '23',
#  '21',
#  '22',
#  '321',
#  '322',
#  '141',
#  '150',
#  '26',
#  '33',
#  '24',
#  '27',
#  '28',
#  '100',
#  '31',
#  '30',
#  '32',
#  '225',
#  '29',
#  '268',
#  '25',
#  '269',
#  '267',
#  '288',
#  '37',
#  '40',
#  '36',
#  '35',
#  '41',
#  '306',
#  '38',
#  '39',
#  '34',
#  '156',
#  '232',
#  '327',
#  '333',
#  '45',
#  '42',
#  '43',
#  '46',
#  '44',
#  '158',
#  '48',
#  '50',
#  '55',
#  '233',
#  '220',
#  '53',
#  '56',
#  '47',
#  '52',
#  '49',
#  '51',
#  '54',
#  '161',
#  '186',
#  '197',
#  '216',
#  '240',
#  '162',
#  '57',
#  '337',
#  '61',
#  '58',
#  '62',
#  '59',
#  '60',
#  '262',
#  '139',
#  '65',
#  '63',
#  '64',
#  '318',
#  '70',
#  '72',
#  '71',
#  '146',
#  '69',
#  '279',
#  '68',
#  '187',
#  '66',
#  '67',
#  '196',
#  '82',
#  '335',
#  '77',
#  '86',
#  '76',
#  '73',
#  '75',
#  '79',
#  '85',
#  '83',
#  '286',
#  '87',
#  '81',
#  '78',
#  '74',
#  '84',
#  '142',
#  '80',
#  '165',
#  '188',
#  '199',
#  '90',
#  '88',
#  '89',
#  '93',
#  '91',
#  '92',
#  '94',
#  '95',
#  '143',
#  '191',
#  '96',
#  '97',
#  '98',
#  '168',
#  '324',
#  '101',
#  '331',
#  '99',
#  '195',
#  '313',
#  '252',
#  '102',
#  '103',
#  '105',
#  '104',
#  '217',
#  '316',
#  '170',
#  '235',
#  '117',
#  '108',
#  '116',
#  '106',
#  '110',
#  '114',
#  '198',
#  '113',
#  '112',
#  '109',
#  '107',
#  '115',
#  '234',
#  '174',
#  '175',
#  '119',
#  '118',
#  '253',
#  '120',
#  '221',
#  '193',
#  '326',
#  '144',
#  '305',
#  '123',
#  '125',
#  '124',
#  '122',
#  '121',
#  '276',
#  '129',
#  '127',
#  '130',
#  '126',
#  '258',
#  '128',
#  '320',
#  '134',
#  '227',
#  '132',
#  '131',
#  '133',
#  '135',
#  '323',
#  '243',
#  '317',
#  '255',
#  '308',
#  '215',
#  '192',
#  '138',
#  '145',
#  '136',
#  '137',
#  '280',
#  '182',
#  '312']
# ids = ['129', '1']
ids = ['2345', '1', '2935', '1177', '1179', '3', '12', '13', '14', '15', '16', '2263', '17', '18', '19', '20', '1109', '22', '21', '26', '23', '24', '27', '28', '25', '29', '1189', '2128', '34', '36', '35', '1193', '1194', '3757', '1200', '33', '3690', '2472', '2381', '31', '32', '30', '1191', '1195', '1196', '1197', '1199', '1201', '1203', '1110', '37', '1205', '194', '195', '196', '1334', '197', '2208', '3441', '68', '2388', '73', '74', '70', '2659', '71', '69', '72', '4', '3961', '1183', '7', '2560', '5', '10', '8', '1184', '1186', '1188', '2680', '2683', '9', '11', '6', '2391', '2720', '136', '134', '135', '1269', '138', '3106', '137', '1270', '139', '2350', '142', '143', '140', '144', '1271', '141', '1149', '2555', '145', '149', '1294', '3829', '3755', '1274', '147', '1277', '146', '1281', '1282', '2180', '148', '1287', '1288', '1279', '1276', '1292', '3440', '150', '1300', '2411', '2041', '189', '3761', '2302', '3458', '185', '186', '187', '2252', '188', '190', '192', '1150', '2946', '191', '193', '1329', '2173', '2471', '1330', '2770', '168', '170', '2109', '171', '167', '173', '169', '172', '174', '175', '2682', '3461', '1306', '1307', '177', '179', '1309', '178', '180', '3422', '1311', '176', '1313', '181', '1314', '1316', '2084', '184', '183', '1318', '2701', '2328', '1320', '1321', '1322', '2364', '182', '3764', '2981', '2663', '557', '2761', '2669', '3632', '42', '43', '44', '2458', '2766', '2338', '3845', '1111', '2500', '2498', '2501', '2672', '151', '152', '161', '1301', '159', '2519', '157', '162', '153', '158', '156', '155', '154', '160', '2313', '3966', '2314', '3932', '166', '1116', '1302', '3633', '165', '164', '163', '93', '94', '2282', '2410', '95', '96', '2518', '97', '98', '99', '100', '101', '103', '104', '102', '105', '3756', '3382', '1252', '3662', '2380', '1253', '2167', '2294', '2157', '116', '2414', '2118', '2775', '1254', '1255', '114', '1256', '117', '115', '111', '2408', '110', '112', '2847', '113', '2460', '108', '1260', '1261', '1262', '1263', '107', '109', '106', '3100', '2757', '119', '120', '122', '118', '121', '123', '1265', '2521', '2176', '128', '2417', '129', '127', '1266', '3433', '1267', '124', '126', '125', '2136', '2691', '2300', '130', '131', '132', '3046', '133', '2571', '2572', '3713', '3787', '199', '2489', '2667', '3860', '2982', '2112', '200', '201', '2664', '2708', '911', '912', '2132', '2291', '1160', '2143', '2366', '2592', '2442', '2144', '2705', '77', '78', '3392', '2676', '2183', '3740', '3699', '2369', '2539', '2613', '2151', '2185', '2848', '2510', '45', '46', '47', '1112', '48', '50', '49', '51', '52', '53', '3701', '54', '55', '3766', '1217', '2425', '1218', '3404', '2514', '1219', '59', '1113', '60', '61', '58', '2196', '57', '56', '1148', '2673', '2333', '2466', '1220', '1221', '1223', '1224', '1226', '62', '63', '64', '66', '67', '1114', '2400', '65', '2528', '2181', '2784', '3763', '80', '82', '81', '2390', '2511', '79', '83', '40', '38', '39', '41', '1336', '2379', '198', '2305', '76', '1248', '1242', '1243', '1244', '1245', '1246', '1247', '75', '1235', '1236', '1237', '1238', '1239', '1240', '1249', '3379', '2158', '1115', '2435', '2707', '2103', '1250', '2561', '84', '89', '88', '87', '85', '86', '92', '1251', '91', '90', '2678', '3419', '2693', '2661', '2743', '232', '1343', '236', '235', '238', '231', '237', '234', '233', '1344', '246', '247', '248', '245', '242', '241', '244', '243', '239', '240', '202', '3707', '210', '1340', '3934', '208', '3811', '2304', '207', '204', '213', '203', '205', '209', '211', '214', '2399', '216', '3810', '217', '3644', '1341', '3467', '3432', '1342', '215', '3466', '219', '3719', '3848', '2545', '2285', '3654', '225', '221', '2202', '222', '1117', '224', '223', '2159', '226', '227', '2670', '218', '2709', '3417', '2710', '3700', '2477', '2476', '228', '229', '3645', '2475', '230', '220', '1118', '1119', '3748', '1122', '1120', '1121', '1337', '255', '260', '258', '257', '1152', '256', '259', '2495', '263', '2248', '2249', '264', '261', '262', '266', '3387', '3109', '265', '269', '267', '2782', '268', '271', '2430', '270', '272', '273', '274', '279', '277', '2470', '1378', '1380', '1363', '1366', '3437', '2768', '1370', '275', '280', '276', '2306', '278', '286', '287', '2496', '1371', '1372', '3677', '1374', '2567', '1373', '1375', '285', '283', '284', '1379', '2467', '3405', '1376', '1377', '282', '1364', '2207', '1383', '281', '2100', '2087', '1386', '326', '327', '328', '329', '1403', '2681', '2140', '2574', '330', '331', '250', '2422', '249', '1151', '3855', '251', '1356', '252', '253', '1355', '290', '291', '289', '1394', '1396', '288', '297', '298', '300', '302', '301', '299', '3788', '293', '2186', '296', '3717', '295', '3394', '1397', '294', '819', '820', '3718', '821', '1159', '1775', '1141', '2131', '2365', '2580', '2312', '3453', '1124', '3859', '306', '2783', '310', '2591', '2287', '311', '3666', '309', '2224', '308', '2288', '2443', '307', '1399', '1123', '303', '1400', '3678', '1401', '305', '304', '3462', '2311', '2575', '1402', '3427', '2164', '2895', '1125', '313', '3876', '314', '315', '316', '317', '318', '319', '312', '321', '322', '2165', '2166', '324', '323', '325', '3805', '2562', '2606', '2602', '2605', '320', '2600', '2184', '2801', '2799', '2803', '2802', '2798', '2800', '254', '3800', '1357', '3802', '3803', '1362', '2805', '2804', '2806', '2807', '2797', '3136', '3375', '363', '360', '359', '358', '361', '2570', '362', '364', '366', '365', '367', '368', '3374', '353', '1127', '354', '355', '357', '356', '374', '373', '3809', '370', '1473', '1474', '3794', '371', '382', '2318', '1440', '1441', '1442', '1444', '1446', '1449', '3807', '2409', '3443', '1448', '1451', '1454', '1462', '1443', '1455', '3403', '3663', '369', '2099', '3664', '3885', '375', '3646', '3795', '2342', '379', '376', '378', '381', '377', '380', '1480', '1475', '1482', '391', '393', '2292', '3468', '392', '395', '394', '397', '398', '2141', '396', '2124', '2315', '2756', '400', '399', '401', '402', '408', '406', '407', '409', '1497', '405', '403', '3397', '3398', '1504', '1505', '410', '1506', '1514', '342', '343', '350', '348', '349', '351', '352', '2113', '345', '346', '347', '344', '333', '2193', '2611', '334', '1126', '1411', '339', '340', '341', '335', '336', '338', '337', '2152', '2378', '416', '412', '413', '414', '2487', '2203', '415', '2906', '411', '2125', '3059', '3060', '2468', '2469', '417', '2105', '384', '385', '386', '389', '387', '388', '2222', '3061', '390', '2363', '3746', '1409', '1410', '3396', '2650', '3863', '3909', '3906', '3369', '1154', '3008', '425', '1529', '426', '2310', '3880', '1527', '2423', '1532', '3722', '3406', '2177', '1153', '3370', '3399', '2563', '3407', '1533', '427', '3858', '2424', '1531', '1518', '419', '418', '420', '1516', '421', '3384', '3739', '2138', '2289', '3636', '438', '440', '439', '443', '444', '445', '1535', '2918', '2915', '441', '442', '1128', '437', '433', '434', '432', '435', '436', '431', '429', '430', '1534', '428', '424', '423', '422', '1515', '1538', '3141', '455', '3711', '457', '3856', '456', '1540', '1542', '458', '1543', '2308', '1541', '2576', '2578', '459', '2309', '1544', '477', '468', '2713', '1545', '1546', '1547', '1548', '478', '3450', '474', '1549', '481', '479', '480', '482', '1550', '466', '470', '467', '472', '471', '469', '475', '476', '2764', '3743', '473', '2478', '2362', '3710', '3731', '501', '502', '2226', '503', '2662', '500', '499', '3024', '2657', '3857', '3416', '3720', '2517', '2614', '3655', '489', '488', '506', '504', '505', '507', '508', '510', '509', '1130', '2334', '3681', '2666', '452', '450', '453', '451', '2227', '454', '2332', '446', '448', '447', '449', '485', '486', '487', '464', '463', '460', '2106', '462', '461', '2108', '1551', '484', '483', '496', '495', '493', '497', '492', '498', '494', '2225', '3742', '2077', '2119', '2641', '2375', '2679', '3950', '3951', '1558', '2583', '2916', '2412', '3922', '3671', '515', '514', '516', '518', '3401', '1561', '517', '513', '519', '1562', '520', '511', '512', '3918', '3737', '2568', '1596', '570', '571', '569', '572', '1597', '573', '1600', '3753', '1599', '574', '530', '534', '1131', '2668', '2102', '532', '526', '1563', '1564', '1565', '1566', '536', '535', '537', '538', '527', '529', '531', '528', '1568', '1569', '1570', '523', '525', '521', '533', '1571', '524', '1572', '3411', '3715', '3730', '2654', '1567', '2403', '1574', '1575', '1576', '1577', '541', '542', '1578', '1580', '1579', '1581', '1582', '1583', '1584', '3650', '1585', '1586', '539', '540', '3463', '584', '3116', '582', '583', '575', '2286', '577', '578', '579', '2449', '581', '2191', '2192', '3412', '3413', '580', '576', '2419', '2716', '585', '587', '586', '2526', '2347', '2340', '2546', '548', '544', '1589', '551', '549', '550', '547', '545', '546', '1590', '543', '2548', '2293', '1132', '3687', '554', '3037', '2428', '555', '2540', '1591', '1592', '2549', '553', '1593', '552', '3942', '1595', '561', '560', '562', '563', '556', '559', '558', '1594', '567', '568', '3038', '565', '3465', '2788', '2789', '3449', '2454', '564', '2111', '3714', '1155', '592', '2101', '591', '1604', '590', '1133', '1134', '3040', '1135', '589', '3846', '2357', '2354', '3747', '1136', '606', '2301', '608', '607', '2523', '614', '613', '609', '610', '611', '2674', '1610', '1611', '1620', '612', '621', '622', '1630', '624', '3402', '623', '620', '618', '619', '1624', '617', '616', '615', '1621', '1157', '3841', '2464', '2587', '2552', '1622', '3383', '2718', '2163', '597', '602', '601', '598', '604', '603', '599', '600', '605', '2344', '2833', '3790', '1156', '596', '2656', '3789', '2123', '2122', '3684', '3685', '593', '594', '595', '2330', '2665', '2331', '2675', '683', '2199', '1684', '2903', '682', '684', '1139', '686', '687', '685', '3963', '2437', '2582', '645', '1667', '1657', '1658', '2085', '3955', '3765', '647', '649', '646', '648', '650', '1664', '3145', '652', '1666', '1669', '1668', '651', '1675', '2771', '2368', '2367', '2104', '3428', '716', '2767', '717', '715', '3804', '1704', '1707', '718', '720', '1706', '713', '719', '714', '1158', '640', '635', '638', '636', '637', '639', '2209', '1653', '1138', '2398', '642', '643', '1650', '2778', '644', '2220', '641', '2133', '3823', '1652', '1634', '627', '625', '1635', '1638', '1639', '2091', '3839', '626', '628', '629', '632', '633', '2725', '634', '2444', '658', '1677', '654', '655', '657', '656', '659', '660', '1676', '661', '2565', '3028', '2320', '3026', '663', '662', '2110', '664', '665', '666', '3637', '709', '3149', '711', '1703', '710', '712', '707', '708', '694', '698', '2073', '696', '695', '697', '2370', '3673', '699', '688', '689', '691', '692', '690', '693', '2394', '703', '702', '1694', '1692', '1695', '1696', '1697', '3828', '1685', '1687', '1688', '2393', '2216', '2211', '701', '1690', '1691', '700', '2395', '2925', '3651', '721', '723', '722', '1712', '1713', '1710', '1711', '2599', '3892', '1682', '674', '677', '672', '678', '673', '675', '676', '2585', '681', '679', '680', '1683', '671', '653', '3847', '631', '3455', '3695', '3456', '630', '3144', '3143', '704', '705', '1702', '706', '3724', '3022', '1678', '667', '668', '669', '670', '1679', '1680', '2079', '3683', '2634', '2126', '2343', '741', '742', '745', '744', '743', '746', '747', '748', '749', '2564', '751', '750', '2129', '1729', '2385', '758', '759', '760', '755', '1732', '2405', '3366', '3112', '3824', '2161', '754', '1730', '1725', '3825', '752', '1728', '2513', '1727', '753', '756', '757', '724', '728', '1716', '726', '725', '727', '3151', '1718', '1717', '3649', '729', '2250', '730', '731', '1720', '1721', '732', '734', '1719', '1722', '735', '1723', '733', '736', '737', '739', '740', '738', '2295', '2296', '2550', '2130', '3434', '769', '2201', '770', '1738', '1739', '768', '761', '762', '1734', '764', '763', '1735', '765', '766', '767', '1737', '1140', '771', '773', '775', '774', '2359', '772', '2516', '776', '1744', '3729', '779', '780', '778', '777', '588', '2195', '3445', '2215', '3638', '2559', '786', '785', '787', '1750', '1751', '2474', '781', '1748', '784', '782', '783', '1760', '2889', '788', '790', '789', '793', '2376', '791', '792', '1763', '1757', '794', '1764', '3808', '3640', '824', '3721', '823', '825', '3736', '1142', '827', '830', '822', '829', '828', '826', '831', '2134', '834', '2433', '3147', '833', '832', '1786', '1792', '1777', '2213', '835', '837', '2278', '1788', '843', '842', '841', '1789', '2473', '839', '1790', '1796', '840', '1797', '838', '1798', '3760', '1791', '3900', '802', '2432', '801', '795', '3378', '1768', '803', '805', '811', '804', '798', '797', '806', '812', '800', '1769', '1770', '2554', '2088', '809', '810', '807', '799', '3107', '808', '796', '1774', '2556', '814', '3745', '817', '2557', '815', '816', '3658', '1771', '1772', '1773', '2264', '813', '818', '2786', '2117', '2387', '2323', '3676', '3429', '2745', '856', '858', '3459', '859', '857', '845', '844', '849', '848', '846', '2316', '847', '2431', '851', '850', '3642', '855', '854', '853', '852', '869', '1817', '1819', '2114', '1820', '868', '1823', '867', '866', '863', '864', '1829', '1830', '1832', '1833', '2386', '865', '870', '1837', '1838', '1840', '2212', '2396', '1804', '1808', '1812', '1841', '2406', '1816', '3821', '860', '3400', '861', '862', '875', '2360', '871', '3150', '872', '3377', '3861', '2450', '874', '2451', '873', '3741', '2553', '2597', '876', '3657', '2434', '1846', '882', '1847', '883', '879', '880', '881', '1848', '1849', '877', '878', '2401', '3840', '3705', '2198', '1801', '3896', '1802', '1803', '2732', '2660', '933', '936', '937', '934', '935', '932', '938', '3852', '3142', '1926', '940', '1923', '1924', '1925', '939', '941', '2486', '3656', '1929', '896', '2630', '898', '897', '893', '891', '890', '892', '894', '895', '904', '2416', '2779', '1891', '1892', '3820', '902', '903', '905', '1894', '1885', '1887', '1890', '899', '1895', '901', '1899', '900', '1896', '888', '889', '1911', '925', '3819', '1910', '926', '1916', '1917', '931', '930', '928', '1913', '1914', '929', '3648', '927', '885', '1856', '1857', '1858', '1859', '1860', '1861', '884', '2736', '908', '3138', '909', '910', '917', '2210', '1908', '920', '919', '922', '2382', '2095', '1904', '2096', '1905', '1906', '2505', '2383', '1907', '3957', '1909', '3442', '2777', '923', '921', '918', '2335', '2337', '2336', '914', '916', '915', '1902', '913', '906', '907', '886', '887', '1875', '2963', '1876', '924', '3643', '2658', '3682', '1880', '1882', '2080', '2234', '1012', '2404', '2677', '1010', '1011', '2491', '1013', '1008', '1014', '1009', '1015', '3114', '1016', '1019', '2307', '2006', '2007', '2009', '3680', '2148', '2010', '2011', '2402', '1017', '2178', '1018', '1020', '947', '1934', '942', '946', '943', '944', '945', '3959', '948', '2522', '2524', '2639', '2637', '3816', '1146', '2584', '2462', '2377', '3365', '3364', '3767', '3667', '957', '3879', '2875', '2115', '3851', '2072', '961', '962', '960', '2494', '1938', '958', '963', '959', '2448', '1941', '1942', '966', '2966', '2738', '965', '1944', '1945', '1946', '964', '956', '955', '2297', '1957', '972', '3653', '1956', '969', '3385', '968', '2120', '967', '2235', '2271', '2413', '971', '970', '1937', '953', '954', '950', '1936', '949', '951', '952', '3674', '2821', '979', '2581', '980', '2975', '982', '2429', '977', '3725', '978', '2146', '986', '987', '976', '984', '985', '983', '988', '981', '1161', '3877', '989', '991', '990', '2083', '992', '996', '1162', '995', '1983', '2776', '1976', '997', '994', '993', '1004', '1978', '1980', '2441', '1979', '1986', '1002', '1003', '1005', '1006', '3439', '1000', '1982', '1001', '2358', '1984', '2389', '3956', '3964', '999', '998', '2179', '1021', '1022', '2349', '1024', '1025', '2566', '1023', '1026', '1028', '1027', '2013', '3631', '1029', '1035', '3410', '2015', '2022', '2281', '1034', '2025', '2026', '2016', '1031', '1032', '2773', '2027', '1033', '2021', '2028', '2029', '2030', '974', '973', '1965', '1966', '2205', '975', '2763', '2170', '3452', '2169', '1007', '3793', '3791', '2063', '2147', '1062', '1063', '2058', '2060', '1061', '1064', '2094', '1163', '2206', '1145', '1070', '1071', '1069', '1072', '1067', '1073', '1068', '1065', '2061', '2062', '2160', '1066', '2655', '566', '1045', '1046', '1042', '3659', '2538', '2052', '2053', '2054', '2055', '1044', '1041', '1040', '1043', '1039', '1144', '1057', '2541', '1048', '1049', '2279', '2280', '1050', '1053', '1052', '1051', '1055', '1056', '1054', '2273', '1047', '2371', '2047', '2741', '3726', '2043', '1036', '1038', '1037', '1143', '2045', '2046', '3652', '3727', '1059', '1058', '3806', '3915', '1060', '1076', '1075', '1074', '3799', '2700', '3728', '3842', '3723', '3421', '3420', '3689', '2352', '3935', '1164', '2298', '2543', '3451', '3418', '2070', '2415', '1098', '1099', '2490', '1100', '1101', '1102', '2071', '2459', '2351', '3665', '1107', '3464', '2688', '2772', '3967', '2544', '1104', '1106', '1105', '1108', '1103', '2339', '2172', '1147', '2086', '1078', '1079', '3414', '2924', '1081', '1082', '1084', '1080', '1085', '1077', '1083', '1086', '2284', '3854', '1088', '1087', '1090', '2135', '1093', '1089', '1091', '1092', '1097', '2355', '2699', '1095', '1094', '1096', '2066', '2834', '2082', '2696', '3670', '3960', '3668', '3669']
class MaicheSpider(scrapy.Spider):
    name = "maichebaodian"
    start_urls = []
    for k in ids:
        start_urls.append('http://m.maiche.com/s%s/'%k)
        # start_urls.append('http://api-v3.maiche.com/api/h5/car-database/get-grouped-serial.htm?brandId=%s&_=0.6756552732341778'%int(k))

    def parse(self, response):
        item = items.BaodianItem()
        s = response.xpath('//div[@class="panoimage-section"]').extract()
        item['series_id'] = int(response.url.split('/')[-2][1:])
        name = response.xpath('//div[@class="l-info"]/span/text()').extract()[0].split(' ')
        if len(name) > 2:
            item['name'] = response.xpath('//div[@class="l-info"]/span/text()').extract()[0].split(' ')[0] + ' ' + response.xpath('//div[@class="l-info"]/span/text()').extract()[0].split(' ')[1]
        else:
            item['name'] = response.xpath('//div[@class="l-info"]/span/text()').extract()[0].split(' ')[0]
        item['url'] = re.search(r'url\("(.*?)!4800', s[0]).group(1)
        yield item
        # res = response.text
        # rv = re.findall(r'serialId":(.*?),"serialImage', res)
    
